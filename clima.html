<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      name="description"
      content="Story Map sobre el Clima y Escenarios de Cambio Climatico en Tlaxcala"
    />
    <title>Clima - Tlaxcala</title>

    <link rel="stylesheet" href="css/variables.css" />
    <link rel="stylesheet" href="css/main.css" />
    <link rel="stylesheet" href="css/navbar.css" />
    <link rel="stylesheet" href="css/story-map.css" />
    <link rel="stylesheet" href="css/clima.css" />

    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/ol@v8.2.0/ol.css"
    />

    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0/dist/chartjs-plugin-datalabels.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/ol@v8.2.0/dist/ol.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
  </head>
  <body>
    <nav class="navbar">
      <div class="navbar-container">
        <a href="index.html" class="navbar-brand">
          <span>Tlaxcala</span>
        </a>

        <button class="navbar-toggle" id="navbarToggle" aria-label="Abrir menu">
          <span class="navbar-toggle-line"></span>
          <span class="navbar-toggle-line"></span>
          <span class="navbar-toggle-line"></span>
        </button>

        <div class="navbar-menu" id="navbarMenu">
          <a href="index.html" class="navbar-link">Inicio</a>
          <a href="vulnerabilidad.html" class="navbar-link">Vulnerabilidad</a>
          <a href="riesgo.html" class="navbar-link">Riesgo</a>
          <a href="amenazas.html" class="navbar-link">Amenazas</a>
          <a href="impactos.html" class="navbar-link">Impactos</a>
          <a href="clima.html" class="navbar-link active">Clima</a>
          <a href="acciones-climaticas.html" class="navbar-link">Acciones Climaticas</a>
          <a href="mitigacion.html" class="navbar-link">Mitigacion</a>
        </div>
      </div>
    </nav>

    <div class="navbar-indicator" id="navbarIndicator"></div>

    <div class="story-map-container">
      <div class="chapters-container" id="chaptersContainer">

        <!-- ============================================================
             CAPITULO 1 - CLIMA Y ESCENARIOS (Layout de 4 mapas)
             ============================================================ -->
        <section class="chapter chapter-clima" id="chapter-1" data-chapter="1">
          <h2 class="map-title">Clima y Escenarios de Cambio Climatico</h2>

          <div class="clima-content">
            <!-- Card 1: Texto explicativo (20% ancho, 100% alto) -->
            <div class="clima-text-card">
              <h3 class="card-title">Clima y Escenarios de Cambio Climático</h3>
              <div class="card-content">
                <p>
                  El clima es mucho más que el estado del tiempo. Es la combinación de temperatura, lluvias, humedad y viento que define cómo vivimos en cada región. Aquí encontrarás información sobre cómo se comporta el clima en Tlaxcala.
                </p>
                <p>
                  Los escenarios climaticos son proyecciones basadas en modelos que simulan
                  como podria cambiar el clima en el futuro, considerando diferentes niveles
                  de emisiones de gases de efecto invernadero.
                </p>
                <p>
                  Para Tlaxcala, se analizan los escenarios SSP2-4.5 (emision intermedia) y
                  SSP5-8.5 (altas emisiones), proyectados al periodo 2041-2060.
                </p>

                <div class="clima-concepts">
                  <h4 class="concept-title">Percentiles climáticos</h4>
                  <div class="concept-item">
                    <span class="concept-label">Q05</span>
                    <span class="concept-desc">Percentil 5 - Representa condiciones mas frias o secas (5% de los valores estan por debajo)</span>
                  </div>
                  <div class="concept-item">
                    <span class="concept-label">Q50</span>
                    <span class="concept-desc">Mediana - Valor central de la distribucion climatica</span>
                  </div>
                  <div class="concept-item">
                    <span class="concept-label">Q95</span>
                    <span class="concept-desc">Percentil 95 - Representa condiciones mas calidas o humedas (95% de los valores estan por debajo)</span>
                  </div>
                </div>

                <p>
                  Explora los mapas para ver como varian las condiciones climaticas
                  entre estaciones y percentiles.
                </p>

                <!-- Selectores de Modelo y Periodo -->
                <div class="clima-selectors">
                  <div class="selector-group">
                    <span class="selector-label">Modelos</span>
                    <div class="selector-buttons">
                      <button class="selector-btn active" data-model="SSP245">SSP245</button>
                      <button class="selector-btn" data-model="SSP585">SSP585</button>
                    </div>
                  </div>
                  <div class="selector-group">
                    <span class="selector-label">Periodo</span>
                    <div class="selector-buttons">
                      <button class="selector-btn active" data-period="2021-2040">2021-2040</button>
                      <button class="selector-btn" data-period="2041-2060">2041-2060</button>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Card 2: Mapa Otoño (40% ancho, 50% alto - superior izquierda) -->
            <div class="clima-map-card map-otono">
              <div class="map-card-header">
                <div>
                  <h4 class="map-card-title">Otoño</h4>
                  <span class="map-card-subtitle">Septiembre - Noviembre</span>
                </div>
              </div>
              <div class="map-container" id="map-1-primavera"></div>
            </div>

            <!-- Card 3: Mapa 2 (40% ancho, 50% alto - superior derecha) -->
            <div class="clima-map-card map-primavera-q">
              <div class="map-container" id="map-1-primavera-q"></div>
            </div>

            <!-- Card 4: Mapa Verano (40% ancho, 50% alto - inferior izquierda) -->
            <div class="clima-map-card map-verano">
              <div class="map-card-header">
                <div>
                  <h4 class="map-card-title">Verano</h4>
                  <span class="map-card-subtitle">Junio - Agosto</span>
                </div>
              </div>
              <div class="map-container" id="map-1-verano"></div>
            </div>

            <!-- Card 5: Mapa Invierno (40% ancho, 50% alto - inferior derecha) -->
            <div class="clima-map-card map-invierno">
              <div class="map-card-header">
                <div>
                  <h4 class="map-card-title">Invierno</h4>
                  <span class="map-card-subtitle">Diciembre - Febrero</span>
                </div>
              </div>
              <div class="map-container" id="map-1-invierno"></div>
            </div>
          </div>
        </section>

        <!-- ============================================================
             CAPITULO 2 - PROYECCIONES CLIMATICAS
             ============================================================ -->
        <section class="chapter" id="chapter-2" data-chapter="2">
          <h2 class="map-title">Proyecciones Climaticas</h2>

          <div class="chapter-map">
            <div class="map-container" id="map-2"></div>
          </div>

          <div class="chapter-text">
            <h2 class="chapter-title">Escenarios Futuros</h2>
            <div class="chapter-content">
              <p>
                Los modelos climaticos proyectan cambios significativos para Tlaxcala
                en las proximas decadas.
              </p>
              <ul>
                <li>Aumento de temperatura: 1.5-2.5 C para 2050</li>
                <li>Mayor frecuencia de eventos extremos</li>
                <li>Cambios en los patrones de precipitacion</li>
                <li>Periodos de sequia mas prolongados</li>
              </ul>
              <p>
                Estos cambios tendran impactos directos en la agricultura, los recursos
                hidricos y la biodiversidad del estado.
              </p>
            </div>
          </div>

          <div class="chapter-chart-info">
            <h2 class="chart-info-title">Precipitacion proyectada</h2>
            <div class="chart-info-content">
              <div class="chart-section">
                <div class="chart-container">
                  <canvas id="chart-2"></canvas>
                </div>
              </div>
              <div class="info-section">
                <div class="info-content">
                  <p>
                    Las proyecciones indican una reduccion en la precipitacion total anual,
                    con una redistribucion temporal que concentrara las lluvias en periodos
                    mas cortos pero intensos.
                  </p>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- ============================================================
             CAPITULO 3 - VARIABILIDAD CLIMATICA
             ============================================================ -->
        <section class="chapter" id="chapter-3" data-chapter="3">
          <h2 class="map-title">Variabilidad Climatica</h2>

          <div class="chapter-map">
            <div class="map-container" id="map-3"></div>
          </div>

          <div class="chapter-text">
            <h2 class="chapter-title">Fenomenos Extremos</h2>
            <div class="chapter-content">
              <p>
                La variabilidad climatica en Tlaxcala se manifiesta a traves de diversos
                fenomenos extremos que afectan a la poblacion y los ecosistemas.
              </p>
              <ul>
                <li>Heladas tempranas y tardias</li>
                <li>Granizadas intensas</li>
                <li>Sequias recurrentes</li>
                <li>Lluvias torrenciales</li>
              </ul>
              <p>
                Comprender estos patrones es fundamental para desarrollar estrategias
                de adaptacion efectivas.
              </p>
            </div>
          </div>

          <div class="chapter-chart-info">
            <h2 class="chart-info-title">Frecuencia de eventos extremos</h2>
            <div class="chart-info-content">
              <div class="chart-section">
                <div class="chart-container">
                  <canvas id="chart-3"></canvas>
                </div>
              </div>
              <div class="info-section">
                <div class="info-content">
                  <p>
                    El registro historico muestra un incremento en la frecuencia e intensidad
                    de eventos climaticos extremos, lo que representa un desafio creciente
                    para la gestion del riesgo.
                  </p>
                </div>
              </div>
            </div>
          </div>
        </section>

      </div>

      <!-- Timeline inferior -->
      <div class="timeline" id="timeline">
        <div class="timeline-item" data-chapter="1">
          <div class="timeline-circle">1</div>
          <div class="timeline-label">Escenarios</div>
        </div>
        <!-- Ocultos temporalmente -->
        <div class="timeline-item" data-chapter="2" style="display: none;">
          <div class="timeline-circle">2</div>
          <div class="timeline-label">Proyecciones</div>
        </div>
        <div class="timeline-item" data-chapter="3" style="display: none;">
          <div class="timeline-circle">3</div>
          <div class="timeline-label">Variabilidad</div>
        </div>
      </div>

      <!-- Botones de navegacion -->
      <div class="nav-buttons left" id="navButtonsLeft">
        <button class="nav-btn" id="btnPrev" aria-label="Capitulo anterior">
          &#8592;
        </button>
      </div>
      <div class="nav-buttons right" id="navButtonsRight">
        <button class="nav-btn" id="btnNext" aria-label="Siguiente capitulo">
          &#8594;
        </button>
      </div>
    </div>

    <script type="module" src="js/config/clima-main.js"></script>

    <script>
      const navbarToggle = document.getElementById("navbarToggle");
      const navbarMenu = document.getElementById("navbarMenu");

      navbarToggle.addEventListener("click", () => {
        navbarToggle.classList.toggle("active");
        navbarMenu.classList.toggle("active");
      });

      const navbarLinks = document.querySelectorAll(".navbar-link");
      navbarLinks.forEach((link) => {
        link.addEventListener("click", () => {
          navbarToggle.classList.remove("active");
          navbarMenu.classList.remove("active");
        });
      });

      const navbar = document.querySelector(".navbar");
      const navbarIndicator = document.getElementById("navbarIndicator");

      window.addEventListener("scroll", () => {
        if (window.scrollY > 50) {
          navbar.classList.add("scrolled");
        } else {
          navbar.classList.remove("scrolled");
        }
      });

      navbarIndicator.addEventListener("mouseenter", () => {
        navbar.classList.add("visible");
      });

      navbar.addEventListener("mouseenter", () => {
        navbar.classList.add("visible");
      });

      navbar.addEventListener("mouseleave", () => {
        navbar.classList.remove("visible");
      });

      navbarIndicator.addEventListener("click", () => {
        navbar.classList.toggle("visible");
      });
    </script>
  </body>
</html>
